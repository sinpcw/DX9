#include"owlExterns.hpp"

//***********************************************************************************************************************************************************************
//		Static	乱数値
//***********************************************************************************************************************************************************************
static	dsfmt_t			_Rand;
static	unsigned int	_Seed;
static	unsigned int	_Call;

//***********************************************************************************************************************************************************************
//		owl::rand::Init(unsigned int)
//			[desc]
//				Mersennne Twisterを初期化する
//			[in]
//				unsigned int	: シード(初期値)
//***********************************************************************************************************************************************************************
void owl::rand::Init(unsigned int _in, unsigned int _call){
	_Seed	= _in;
	_Call	= _call;
	dsfmt_init_gen_rand(&_Rand, _Seed);
	for(unsigned int i = 0; i < _call; i++){
		dsfmt_genrand_close_open(&_Rand);
	}
}

//***********************************************************************************************************************************************************************
//		owl::rand::Gain()
//			[desc]
//				浮動小数の乱数値を返す
//			[out]
//				float			: 乱数値 [0, 1)
//***********************************************************************************************************************************************************************
float owl::rand::Gain(){
	_Call++;
	return static_cast<float>(dsfmt_genrand_close_open(&_Rand));
}

//***********************************************************************************************************************************************************************
//		owl::rand::Call()
//			[desc]
//				Mersennne Twisterの呼び出し回数を返す
//			[out]
//				int				: 呼び出し回数
//***********************************************************************************************************************************************************************
unsigned int owl::rand::Call(){
	return _Call;
}

//***********************************************************************************************************************************************************************
//		owl::rand::GetFlt()
//			[desc]
//				浮動小数の乱数値を返す
//			[out]
//				float			: 乱数値 [0, 1)
//***********************************************************************************************************************************************************************
float owl::rand::GetFlt(){
	_Call++;
	return static_cast<float>(dsfmt_genrand_close_open(&_Rand));
}

//***********************************************************************************************************************************************************************
//		owl::rand::GetInt()
//			[desc]
//				整数の乱数値を返す
//			[out]
//				int				: 乱数値 [0, 2147483647)
//***********************************************************************************************************************************************************************
int owl::rand::GetInt(){
	_Call++;
	return (0x7FFFFFFF & (dsfmt_genrand_uint32(&_Rand) >> 1));
}

//***********************************************************************************************************************************************************************
//		owl::rand::GetInt(int)
//			[desc]
//				整数の乱数値を返す
//			[in]
//				unsigned int	: 整数値
//			[out]
//				int				: 乱数値 [0, in)
//***********************************************************************************************************************************************************************
int owl::rand::GetInt(unsigned int _in){
	_Call++;
	return static_cast<int>(dsfmt_genrand_uint32(&_Rand) % ((_in < 1) ? (1) : (_in)));
}

//***********************************************************************************************************************************************************************
//		owl::rand::GetIdx()
//			[desc]
//				dsfmtのidx値を返す
//			[out]
//				int				: idx値
//***********************************************************************************************************************************************************************
int owl::rand::GetIdx(){
	return _Rand.idx;
}


//***********************************************************************************************************************************************************************
//		owl::rand::SetIdx()
//			[desc]
//				dsfmtのidx値を返す
//			[in]
//				int				: idx値
//***********************************************************************************************************************************************************************
void owl::rand::SetIdx(int _in){
	_Rand.idx	= _in;
}
