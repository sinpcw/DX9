#include"owlCore.hpp"

//***********************************************************************************************************************************************************************
//		PseudoColor(float)
//			[desc]
//				‹^—ƒJƒ‰[‚ğ‹‚ß‚é
//			[in]
//				ˆÊ‘Š(0.0`1.0)‚ğ“ü—Í
//***********************************************************************************************************************************************************************
owl::core::COLORf owl::core::PseudoColor(float _in){
	float	r	= (sin(2.0f * owl::core::PI * _in + DtR( 90.0f)) + 1) * 0.5f;
	float	g	= (sin(2.0f * owl::core::PI * _in + DtR(210.0f)) + 1) * 0.5f;
	float	b	= (sin(2.0f * owl::core::PI * _in + DtR(330.0f)) + 1) * 0.5f;
	return owl::core::COLORf(r, g, b, 1.0f);
}

//***********************************************************************************************************************************************************************
//		TrueColor32(const COLOR8 &)
//			[desc]
//				ARGB(32bit : 0`255, 0`255, 0`255, 0`255)ƒJƒ‰[‚ğ‹‚ß‚é
//			[in]
//				³‹K‰»”(0.0`1.0)‚ğ“ü—Í
//***********************************************************************************************************************************************************************
unsigned int owl::core::TrueColor32(const COLOR8 &_v){
	unsigned int	_color	= 0;
	_color	|= std::max<unsigned int>(0, std::min<unsigned int>(static_cast<unsigned int>(_v.r), 255)) << 16;
	_color	|= std::max<unsigned int>(0, std::min<unsigned int>(static_cast<unsigned int>(_v.g), 255)) <<  8;
	_color	|= std::max<unsigned int>(0, std::min<unsigned int>(static_cast<unsigned int>(_v.b), 255)) <<  0;
	_color	|= std::max<unsigned int>(0, std::min<unsigned int>(static_cast<unsigned int>(_v.a), 255)) << 24;
	return _color;
}

//***********************************************************************************************************************************************************************
//		TrueColor32(const COLORf &)
//			[desc]
//				ARGB(32bit : 0`255, 0`255, 0`255, 0`255)ƒJƒ‰[‚ğ‹‚ß‚é
//			[in]
//				³‹K‰»”(0.0`1.0)‚ğ“ü—Í
//***********************************************************************************************************************************************************************
unsigned int owl::core::TrueColor32(const COLORi &_v){
	unsigned int	_color	= 0;
	_color	|= std::max<unsigned int>(0, std::min<unsigned int>(static_cast<unsigned int>(_v.r), 255)) << 16;
	_color	|= std::max<unsigned int>(0, std::min<unsigned int>(static_cast<unsigned int>(_v.g), 255)) <<  8;
	_color	|= std::max<unsigned int>(0, std::min<unsigned int>(static_cast<unsigned int>(_v.b), 255)) <<  0;
	_color	|= std::max<unsigned int>(0, std::min<unsigned int>(static_cast<unsigned int>(_v.a), 255)) << 24;
	return _color;
}

//***********************************************************************************************************************************************************************
//		TrueColor32(const COLORf &)
//			[desc]
//				ARGB(32bit : 0`255, 0`255, 0`255, 0`255)ƒJƒ‰[‚ğ‹‚ß‚é
//			[in]
//				³‹K‰»”(0.0`1.0)‚ğ“ü—Í
//***********************************************************************************************************************************************************************
unsigned int owl::core::TrueColor32(const COLORf &_v){
	unsigned int	_color	= 0;
	_color	|= std::max<unsigned int>(0, std::min<unsigned int>(static_cast<unsigned int>(255.0f * _v.r), 255)) << 16;
	_color	|= std::max<unsigned int>(0, std::min<unsigned int>(static_cast<unsigned int>(255.0f * _v.g), 255)) <<  8;
	_color	|= std::max<unsigned int>(0, std::min<unsigned int>(static_cast<unsigned int>(255.0f * _v.b), 255)) <<  0;
	_color	|= std::max<unsigned int>(0, std::min<unsigned int>(static_cast<unsigned int>(255.0f * _v.a), 255)) << 24;
	return _color;
}

//***********************************************************************************************************************************************************************
//		MinSquared
//			[desc]
//				“ü—Í’lˆÈã‚ÌÅ¬‚Ì2‚Ì‚×‚«æ‚ğ‹‚ß‚é
//			[in]
//				’l
//***********************************************************************************************************************************************************************
unsigned int owl::core::MinSquared(unsigned int _in){
#if	(0)
	unsigned int	_vi	= 1;
	if((_in & (_in - 1)) == 0){
		return _in;
	}
	while(_in > 0){
		_in	>>= 1;
		_vi	<<= 1;
	}
	return _vi;
#else
	unsigned int	_sf;
	if((_in & (_in - 1)) == 0){
		return _in;
	}
	__asm { 
		MOV	EAX, _in; 
		BSR	EAX, EAX; 
		MOV	_sf, EAX; 
	}
	return (_in & (1 << _sf)) << 1;
#endif
}

//***********************************************************************************************************************************************************************
//		CvtStrW()
//			[desc]
//				ASCII‚©‚çUnicode‚É•ÏŠ·‚·‚é
//			[in]
//				•ÏŠ·Œã‚Ì•¶š—ñ
//***********************************************************************************************************************************************************************
const wchar_t * owl::core::CvtStrW(const char *_in){
	static wchar_t	_str[256]	= { 0 };
	mbstowcs(_str, _in, 255);
	return _str;
}

//***********************************************************************************************************************************************************************
//		CvtStrA()
//			[desc]
//				Unicode‚©‚çASCII‚É•ÏŠ·‚·‚é
//			[in]
//				•ÏŠ·Œã‚Ì•¶š—ñ
//***********************************************************************************************************************************************************************
const char * owl::core::CvtStrA(const wchar_t *_in){
	static char		_str[512]	= { 0 };
	wcstombs(_str, _in, 511);
	return _str;
}

//***********************************************************************************************************************************************************************
//		GCD()
//			[desc]
//				Å‘åŒö–ñ”‚ğ‹‚ß‚é
//			[in]
//				‹‚ß‚é”’l
//***********************************************************************************************************************************************************************
int owl::core::GCD(int _in1, int _in2){
	int		_t, _x, _y;
	if(_in1 < _in2){
		_x	= _in2;
		_y	= _in1;
	}else{
		_x	= _in1;
		_y	= _in2;
	}
	while(_y != 0){
		_t	= _x % _y;
		_x	= _y;
		_y	= _t;
	}
	return (_x);
}

//***********************************************************************************************************************************************************************
//		LCM()
//			[desc]
//				Å¬Œö”{”‚ğ‹‚ß‚é
//			[in]
//				‹‚ß‚é”’l
//***********************************************************************************************************************************************************************
int owl::core::LCM(int _in1, int _in2){
	return (_in1 * _in2) / GCD(_in1, _in2);
}


//***********************************************************************************************************************************************************************
//		owl::core::IsExistFile(wchar_t *)
//			[desc]
//				ƒtƒ@ƒCƒ‹‚Ì‘¶İ‚ğŠm”F‚·‚é
//			[in]
//				ƒtƒ@ƒCƒ‹–¼
//***********************************************************************************************************************************************************************
bool owl::core::IsExistFile(const wchar_t *_in){
	FILE *	fp;
	if(0 != _wfopen_s(&fp, _in, L"rb")){
		return (false);
	}
	fclose(fp);
	return (true);
}